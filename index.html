<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SEBU Lern-App - Verkehrsrecht/Verkehrslehre</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState } = React;

    // Lucide React Icons als einfache SVG-Komponenten
    const BookOpen = ({ className, style }) => (
      <svg className={className} style={style} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
      </svg>
    );

    const Award = ({ className, style }) => (
      <svg className={className} style={style} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="8" r="7"></circle>
        <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
      </svg>
    );

    const CheckCircle = ({ className, style }) => (
      <svg className={className} style={style} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );

    const XCircle = ({ className, style }) => (
      <svg className={className} style={style} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
    );

    const RefreshCw = ({ className, style }) => (
      <svg className={className} style={style} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="23 4 23 10 17 10"></polyline>
        <polyline points="1 20 1 14 7 14"></polyline>
        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
      </svg>
    );

    const quizData = {
      geschwindigkeit: {
        title: "Geschwindigkeit",
        questions: [
          {
            id: 1,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Pkw i.g.O. (innerhalb geschlossener Ortschaften)?",
            options: ["30 km/h", "50 km/h", "60 km/h", "70 km/h"],
            correctAnswer: "50 km/h",
            explanation: "Pkw innerhalb geschlossener Ortschaften: 50 km/h"
          },
          {
            id: 2,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Lkw 12 t/Anhänger a.g.O. (außerhalb geschlossener Ortschaften)?",
            options: ["50 km/h", "60 km/h", "80 km/h", "100 km/h"],
            correctAnswer: "60 km/h",
            explanation: "Lkw mit Anhänger außerhalb geschlossener Ortschaften: 60 km/h"
          },
          {
            id: 3,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Krad a.g.O. (außerhalb geschlossener Ortschaften)?",
            options: ["80 km/h", "100 km/h", "120 km/h", "130 km/h"],
            correctAnswer: "100 km/h",
            explanation: "Kraftrad außerhalb geschlossener Ortschaften: 100 km/h"
          },
          {
            id: 4,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für KOM mit stehenden Fahrgästen a.g.O. (außerhalb geschlossener Ortschaften)?",
            options: ["50 km/h", "60 km/h", "80 km/h", "100 km/h"],
            correctAnswer: "60 km/h",
            explanation: "Kraftomnibusse mit stehenden Fahrgästen außerhalb geschlossener Ortschaften: 60 km/h"
          },
          {
            id: 5,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Wohnmobil 4,8 t, a.g.O. (außerhalb geschlossener Ortschaften)?",
            options: ["60 km/h", "80 km/h", "100 km/h", "120 km/h"],
            correctAnswer: "80 km/h",
            explanation: "Wohnmobil über 3,5 t bis 7,5 t außerhalb geschlossener Ortschaften: 80 km/h"
          },
          {
            id: 6,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Pkw auf der BAB (Bundesautobahn)?",
            options: ["100 km/h", "130 km/h", "150 km/h", "keine Begrenzung"],
            correctAnswer: "keine Begrenzung",
            explanation: "Pkw auf Autobahnen: keine generelle Höchstgeschwindigkeitsbegrenzung (Richtgeschwindigkeit 130 km/h)"
          },
          {
            id: 7,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Lkw 34 t auf der BAB (Bundesautobahn)?",
            options: ["60 km/h", "80 km/h", "100 km/h", "120 km/h"],
            correctAnswer: "80 km/h",
            explanation: "Lkw über 3,5 t auf Autobahnen: 80 km/h"
          },
          {
            id: 8,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Pkw/Anhänger auf der BAB (Bundesautobahn)?",
            options: ["80 km/h", "100 km/h", "120 km/h", "130 km/h"],
            correctAnswer: "100 km/h",
            explanation: "Pkw mit Anhänger auf Autobahnen: 100 km/h"
          },
          {
            id: 9,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Krad auf der BAB (Bundesautobahn)?",
            options: ["100 km/h", "130 km/h", "150 km/h", "keine Begrenzung"],
            correctAnswer: "keine Begrenzung",
            explanation: "Kraftrad auf Autobahnen: keine generelle Höchstgeschwindigkeitsbegrenzung"
          },
          {
            id: 10,
            type: "single-choice",
            question: "Wie hoch ist die zulässige Höchstgeschwindigkeit für Wohnmobil 4,8 t/Anhänger?",
            options: ["50 km/h", "60 km/h", "80 km/h", "100 km/h"],
            correctAnswer: "60 km/h",
            explanation: "Wohnmobil über 3,5 t mit Anhänger: 60 km/h"
          }
        ]
      },
      tbnr: {
        title: "Übung: TBNR zu § 4 StVO",
        questions: [
          {
            id: 1,
            type: "tbnr-input",
            question: "Pkw, 80 km/h, Abstand 35 m",
            correctAnswer: "104100",
            explanation: "TBNR 104100: Pkw bei 80 km/h mit weniger als 5/10 des halben Tachowertes Abstand (weniger als 40 m)"
          },
          {
            id: 2,
            type: "tbnr-input",
            question: "Lkw, 12 t, 80 km/h auf BAB, Abstand 40 m",
            correctAnswer: "104636",
            explanation: "TBNR 104636: Lkw über 3,5 t auf BAB bei 80 km/h mit weniger als 5/10 des halben Tachowertes Abstand"
          },
          {
            id: 3,
            type: "tbnr-input",
            question: "Wohnmobil/Anhänger, 4,8 t, 60 km/h, a.g.O., Zweirichtungsverkehr mit jeweils einem Fahrstreifen pro Richtung, Abstand 50 m",
            correctAnswer: "104104",
            explanation: "TBNR 104104: Fahrzeug mit Anhänger bei mehr als 50 km/h, Abstand weniger als 50 m"
          },
          {
            id: 4,
            type: "tbnr-input",
            question: "Pkw, 180 km/h auf BAB, Abstand 35 m",
            correctAnswer: "104613",
            explanation: "TBNR 104613: Pkw bei mehr als 130 km/h mit weniger als 5/10 des halben Tachowertes Abstand (unter 80 m bei 130+ km/h)"
          },
          {
            id: 5,
            type: "tbnr-input",
            question: "Krad, 100 km/h, a.g.O., Zweirichtungsverkehr mit jeweils zwei Fahrstreifen pro Richtung, Abstand 12 m",
            correctAnswer: "104602",
            explanation: "TBNR 104602: Kraftrad bei mehr als 80 km/h mit weniger als 4/10 des halben Tachowertes Abstand"
          }
        ]
      }
    };

    function App() {
      const [selectedTopic, setSelectedTopic] = useState(null);
      const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
      const [userAnswer, setUserAnswer] = useState('');
      const [multiAnswers, setMultiAnswers] = useState({});
      const [showFeedback, setShowFeedback] = useState(false);
      const [isCorrect, setIsCorrect] = useState(false);
      const [multiResults, setMultiResults] = useState({});
      const [results, setResults] = useState([]);
      const [quizCompleted, setQuizCompleted] = useState(false);

      const startQuiz = (topic) => {
        setSelectedTopic(topic);
        setCurrentQuestionIndex(0);
        setUserAnswer('');
        setMultiAnswers({});
        setShowFeedback(false);
        setMultiResults({});
        setResults([]);
        setQuizCompleted(false);
      };

      const checkAnswer = () => {
        const question = quizData[selectedTopic].questions[currentQuestionIndex];
        let correct = false;

        if (question.type === 'single-choice') {
          correct = userAnswer === question.correctAnswer;
        } else if (question.type === 'free-text') {
          const normalizedAnswer = userAnswer.toLowerCase().trim();
          correct = question.acceptedAnswers.some(
            accepted => accepted.toLowerCase() === normalizedAnswer
          );
        } else if (question.type === 'tbnr-input') {
          correct = userAnswer.trim() === question.correctAnswer;
        } else if (question.type === 'multi-free-text') {
          const newMultiResults = {};
          let allCorrect = true;
          question.subQuestions.forEach((subQ, index) => {
            const userAns = (multiAnswers[index] || '').trim();
            const isSubCorrect = userAns === subQ.correctAnswer;
            newMultiResults[index] = isSubCorrect;
            if (!isSubCorrect) allCorrect = false;
          });
          setMultiResults(newMultiResults);
          correct = allCorrect;
        }

        setIsCorrect(correct);
        setShowFeedback(true);
        setResults([...results, { questionId: question.id, correct }]);
      };

      const nextQuestion = () => {
        const questions = quizData[selectedTopic].questions;
        if (currentQuestionIndex < questions.length - 1) {
          setCurrentQuestionIndex(currentQuestionIndex + 1);
          setUserAnswer('');
          setMultiAnswers({});
          setShowFeedback(false);
          setMultiResults({});
        } else {
          setQuizCompleted(true);
        }
      };

      const resetQuiz = () => {
        setSelectedTopic(null);
        setCurrentQuestionIndex(0);
        setUserAnswer('');
        setMultiAnswers({});
        setShowFeedback(false);
        setMultiResults({});
        setResults([]);
        setQuizCompleted(false);
      };

      if (!selectedTopic) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-red-50 to-orange-100 p-4">
            <div className="max-w-4xl mx-auto pt-8">
              <div className="text-center mb-12">
                <BookOpen className="w-16 h-16 mx-auto mb-4" style={{ color: '#823125' }} />
                <h1 className="text-4xl font-bold text-gray-800 mb-2">
                  SEBU Lern-App<br />Verkehrsrecht/<br />Verkehrslehre
                </h1>
                <p className="text-gray-600">Wähle ein Thema und teste dein Wissen!</p>
              </div>
              
              <div className="grid md:grid-cols-3 gap-6">
                {Object.entries(quizData).map(([key, topic]) => (
                  <button
                    key={key}
                    onClick={() => startQuiz(key)}
                    className="bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-all transform hover:-translate-y-1"
                  >
                    <div className="text-center">
                      <div className="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4" style={{ backgroundColor: '#82312520' }}>
                        <BookOpen className="w-8 h-8" style={{ color: '#823125' }} />
                      </div>
                      <h2 className="text-xl font-semibold text-gray-800 mb-2">{topic.title}</h2>
                      <p className="text-gray-600 text-sm">{topic.questions.length} Fragen</p>
                    </div>
                  </button>
                ))}
              </div>
            </div>
          </div>
        );
      }

      const currentTopic = quizData[selectedTopic];
      const currentQuestion = currentTopic.questions[currentQuestionIndex];
      const correctAnswers = results.filter(r => r.correct).length;
      const totalQuestions = currentTopic.questions.length;

      if (quizCompleted) {
        const percentage = Math.round((correctAnswers / totalQuestions) * 100);
        
        return (
          <div className="min-h-screen bg-gradient-to-br from-red-50 to-orange-100 p-4">
            <div className="max-w-2xl mx-auto pt-12">
              <div className="bg-white rounded-xl shadow-xl p-8 text-center">
                <Award className="w-20 h-20 mx-auto mb-6 text-yellow-500" />
                <h2 className="text-3xl font-bold text-gray-800 mb-4">Quiz abgeschlossen!</h2>
                
                <div className="mb-8">
                  <div className="text-6xl font-bold mb-2" style={{ color: '#823125' }}>{percentage}%</div>
                  <p className="text-gray-600 text-lg">
                    {correctAnswers} von {totalQuestions} Fragen richtig beantwortet
                  </p>
                </div>

                <div className="bg-gray-50 rounded-lg p-6 mb-6">
                  <h3 className="font-semibold text-gray-800 mb-4">Deine Ergebnisse:</h3>
                  <div className="space-y-2">
                    {results.map((result, index) => (
                      <div key={index} className="flex items-center justify-between">
                        <span className="text-gray-700">Frage {index + 1}</span>
                        {result.correct ? (
                          <CheckCircle className="w-6 h-6 text-green-500" />
                        ) : (
                          <XCircle className="w-6 h-6 text-red-500" />
                        )}
                      </div>
                    ))}
                  </div>
                </div>

                <div className="flex gap-4 justify-center">
                  <button
                    onClick={() => startQuiz(selectedTopic)}
                    className="flex items-center gap-2 text-white px-6 py-3 rounded-lg transition-colors"
                    style={{ backgroundColor: '#823125' }}
                    onMouseEnter={(e) => e.target.style.backgroundColor = '#6b2820'}
                    onMouseLeave={(e) => e.target.style.backgroundColor = '#823125'}
                  >
                    <RefreshCw className="w-5 h-5" />
                    Nochmal üben
                  </button>
                  <button
                    onClick={resetQuiz}
                    className="bg-gray-200 text-gray-800 px-6 py-3 rounded-lg hover:bg-gray-300 transition-colors"
                  >
                    Thema wechseln
                  </button>
                </div>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-red-50 to-orange-100 p-4">
          <div className="max-w-2xl mx-auto pt-8">
            <div className="mb-6 flex justify-between items-center">
              <button
                onClick={resetQuiz}
                className="font-medium"
                style={{ color: '#823125' }}
              >
                ← Zurück zur Themenauswahl
              </button>
              <div className="text-gray-600 font-medium">
                Frage {currentQuestionIndex + 1} von {totalQuestions}
              </div>
            </div>

            <div className="bg-white rounded-xl shadow-xl p-8">
              <h2 className="text-2xl font-bold text-gray-800 mb-2">{currentTopic.title}</h2>
              <div className="w-full bg-gray-200 rounded-full h-2 mb-8">
                <div
                  className="h-2 rounded-full transition-all"
                  style={{ 
                    width: `${((currentQuestionIndex + 1) / totalQuestions) * 100}%`,
                    backgroundColor: '#823125'
                  }}
                ></div>
              </div>

              <div className="mb-8">
                <p className="text-lg text-gray-700 mb-6">{currentQuestion.question}</p>

                {currentQuestion.type === 'single-choice' ? (
                  <div className="space-y-3">
                    {currentQuestion.options.map((option) => (
                      <button
                        key={option}
                        onClick={() => setUserAnswer(option)}
                        disabled={showFeedback}
                        className={`w-full text-left p-4 rounded-lg border-2 transition-all ${
                          userAnswer === option
                            ? 'bg-red-50'
                            : 'border-gray-200 hover:border-red-300'
                        } ${showFeedback ? 'cursor-not-allowed' : 'cursor-pointer'}`}
                        style={userAnswer === option ? { borderColor: '#823125' } : {}}
                      >
                        {option}
                      </button>
                    ))}
                  </div>
                ) : currentQuestion.type === 'tbnr-input' ? (
                  <div>
                    <input
                      type="text"
                      value={userAnswer}
                      onChange={(e) => {
                        const value = e.target.value;
                        if (/^\d{0,6}$/.test(value)) {
                          setUserAnswer(value);
                        }
                      }}
                      disabled={showFeedback}
                      placeholder="6-stellige TBNR eingeben..."
                      maxLength="6"
                      className="w-full p-4 border-2 border-gray-200 rounded-lg focus:outline-none text-center text-2xl font-mono tracking-wider"
                      style={userAnswer && userAnswer.length === 6 ? { borderColor: '#823125' } : {}}
                    />
                    <p className="text-sm text-gray-500 mt-2 text-center">
                      {userAnswer.length}/6 Ziffern
                    </p>
                  </div>
                ) : currentQuestion.type === 'multi-free-text' ? (
                  <div className="space-y-4">
                    {currentQuestion.subQuestions.map((subQ, index) => (
                      <div key={index}>
                        <label className="block text-gray-700 font-medium mb-2">{subQ.label}</label>
                        <input
                          type="number"
                          value={multiAnswers[index] || ''}
                          onChange={(e) => setMultiAnswers({...multiAnswers, [index]: e.target.value})}
                          disabled={showFeedback}
                          placeholder="Geschwindigkeit eingeben..."
                          className="w-full p-3 border-2 border-gray-200 rounded-lg focus:outline-none"
                          style={multiAnswers[index] ? { borderColor: '#823125' } : {}}
                        />
                        {showFeedback && (
                          <div className={`mt-2 p-2 rounded ${multiResults[index] ? 'bg-green-50' : 'bg-red-50'}`}>
                            <div className="flex items-center gap-2">
                              {multiResults[index] ? (
                                <CheckCircle className="w-5 h-5 text-green-600" />
                              ) : (
                                <XCircle className="w-5 h-5 text-red-600" />
                              )}
                              <span className={`text-sm ${multiResults[index] ? 'text-green-800' : 'text-red-800'}`}>
                                {multiResults[index] ? '✅ Richtig!' : subQ.explanation}
                              </span>
                            </div>
                          </div>
                        )}
                      </div>
                    ))}
                  </div>
                ) : (
                  <input
                    type="text"
                    value={userAnswer}
                    onChange={(e) => setUserAnswer(e.target.value)}
                    disabled={showFeedback}
                    placeholder="Deine Antwort eingeben..."
                    className="w-full p-4 border-2 border-gray-200 rounded-lg focus:outline-none"
                    style={userAnswer ? { borderColor: '#823125' } : {}}
                  />
                )}
              </div>

              {showFeedback && currentQuestion.type !== 'multi-free-text' && (
                <div className={`mb-6 p-4 rounded-lg ${isCorrect ? 'bg-green-50' : 'bg-red-50'}`}>
                  <div className="flex items-start gap-3">
                    {isCorrect ? (
                      <CheckCircle className="w-6 h-6 text-green-600 flex-shrink-0 mt-1" />
                    ) : (
                      <XCircle className="w-6 h-6 text-red-600 flex-shrink-0 mt-1" />
                    )}
                    <div>
                      <p className={`font-semibold mb-2 ${isCorrect ? 'text-green-800' : 'text-red-800'}`}>
                        {isCorrect ? '✅ Richtig!' : 'Leider falsch!'}
                      </p>
                      <p className="text-gray-700">{currentQuestion.explanation}</p>
                      {!isCorrect && currentQuestion.type === 'single-choice' && (
                        <p className="text-gray-700 mt-2">
                          Richtige Antwort: <strong>{currentQuestion.correctAnswer}</strong>
                        </p>
                      )}
                    </div>
                  </div>
                </div>
              )}

              <div className="flex justify-end">
                {!showFeedback ? (
                  <button
                    onClick={checkAnswer}
                    disabled={currentQuestion.type === 'multi-free-text' 
                      ? Object.keys(multiAnswers).length !== currentQuestion.subQuestions.length 
                      : currentQuestion.type === 'tbnr-input' 
                      ? userAnswer.length !== 6
                      : !userAnswer}
                    className="text-white px-8 py-3 rounded-lg transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"
                    style={{ backgroundColor: 
                      (currentQuestion.type === 'multi-free-text' 
                        ? Object.keys(multiAnswers).length === currentQuestion.subQuestions.length 
                        : currentQuestion.type === 'tbnr-input'
                        ? userAnswer.length === 6
                        : userAnswer) ? '#823125' : '' 
                    }}
                    onMouseEnter={(e) => { 
                      if ((currentQuestion.type === 'multi-free-text' 
                        ? Object.keys(multiAnswers).length === currentQuestion.subQuestions.length 
                        : currentQuestion.type === 'tbnr-input'
                        ? userAnswer.length === 6
                        : userAnswer)) e.target.style.backgroundColor = '#6b2820'; 
                    }}
                    onMouseLeave={(e) => { 
                      if ((currentQuestion.type === 'multi-free-text' 
                        ? Object.keys(multiAnswers).length === currentQuestion.subQuestions.length 
                        : currentQuestion.type === 'tbnr-input'
                        ? userAnswer.length === 6
                        : userAnswer)) e.target.style.backgroundColor = '#823125'; 
                    }}
                  >
                    Antwort prüfen
                  </button>
                ) : (
                  <button
                    onClick={nextQuestion}
                    className="text-white px-8 py-3 rounded-lg transition-colors"
                    style={{ backgroundColor: '#823125' }}
                    onMouseEnter={(e) => e.target.style.backgroundColor = '#6b2820'}
                    onMouseLeave={(e) => e.target.style.backgroundColor = '#823125'}
                  >
                    {currentQuestionIndex < totalQuestions - 1 ? 'Nächste Frage' : 'Ergebnisse anzeigen'}
                  </button>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
