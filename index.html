<!DOCTYPE html>
<html lang="de">
<head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#823125">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SEBU Lern-App - Übungssachverhalte Verkehrsrecht GS</title>
  <style>
    body { font-family: system-ui, sans-serif; background: #f6f6f6; color: #222; margin: 0; padding: 0; }
    header { background: #823125; color: white; text-align: center; padding: 1.2rem; }
    h1 { margin: 0.2em 0 0.1em; font-size: 1.4rem; }
    h2 { margin: 0; font-weight: normal; font-size: 1rem; opacity: 0.9; }
    main { max-width: 700px; margin: 2rem auto; background: white; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); padding: 2rem; }

    .start-page button { display: block; width: 100%; margin-bottom: 1rem; padding: 1rem; font-size: 1rem; border-radius: 8px; border: 1px solid #823125; background: #fff8f6; cursor: pointer; transition: all 0.2s ease; }
    .start-page button:hover { background: #f0e5e2; }

    .case-box { background: #fff8f6; border-left: 6px solid #823125; padding: 1rem 1.2rem; border-radius: 8px; margin-bottom: 2rem; }
    .case-box h3 { margin-top: 0; color: #823125; }

    .question { margin-bottom: 2rem; }
    .question h3 { margin-bottom: 0.6rem; }
    button.answer-btn { display: block; margin-top: 0.5rem; background: #eaeaea; border: 1px solid #ccc; border-radius: 6px; padding: 0.4rem 0.8rem; width: 100%; text-align: left; cursor: pointer; transition: all 0.2s ease; }
    button.answer-btn:hover { background: #f0f0f0; }
    button.correct { background: #c8e6c9; border-color: #388e3c; color: #2e7d32; }
    button.incorrect { background: #ffcdd2; border-color: #c62828; color: #b71c1c; }
    .feedback { margin-top: 0.3rem; font-size: 0.9rem; }
    .correct-answer { background-color: #d4edda !important; border-radius: 6px; padding: 2px 6px; }
    .summary { text-align: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ccc; font-weight: bold; font-size: 1rem; color: #823125; }
    .footer-note { text-align: center; font-size: 0.8rem; margin-top: 2rem; color: #666; }
    .back-btn { margin-top: 2rem; background: #823125; color: white; border: none; padding: 0.8rem 1.2rem; border-radius: 6px; cursor: pointer; }
    .back-btn:hover { background: #a23d2f; }

    /* Hinweis-Box unterhalb des Inhalts */
    .app-hint {
      font-size: 0.85rem;            /* kleinerer Text */
      color: #823125;                 /* SEBU-Rot */
      background-color: #ffffff;      /* weißer Hintergrund */
      border: 1px solid #823125;     /* Rahmenfarbe SEBU-Rot */
      border-radius: 8px;
      padding: 0.8rem 1rem;
      max-width: 700px;
      line-height: 1.3;
      text-align: center;
      margin: 2rem auto 1rem auto;   /* Abstand oben/unten, zentriert */
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

<header>
  <h1>SEBU Lern-App – Übungssachverhalte Verkehrsrecht GS</h1>
  <h2>Dipl.-Verww. (FH) PHK Sebastian Burbach, M.A.</h2>
</header>

<main>
  <!-- Startseite -->
  <div id="startPage" class="start-page">
    <button onclick="openCase('case0')">Übung: Definitionen/Auslegungen</button>
    <button onclick="openCase('case1')">Übungsfall: Kind als Radfahrer auf dem Gehweg</button>
    <button onclick="openCase('case2')">Übungsfall: Höchstgeschwindigkeiten</button>
    <button onclick="openCase('case3')">Übung: Grundlagen des § 1 Abs. 2 StVO</button>
    <button onclick="openCase('case4')">Übung: TBNR zu § 4 StVO</button>
  </div>

  <!-- Fall 0 bis Fall 3 unverändert von deinem Originalcode -->
  <!-- Fall 0 -->
  <section id="case0" style="display:none;">
    <div class="case-box">
      <h3>Übung: Definitionen/Auslegungen</h3>
      <p><strong>Aufgabe:</strong> Ordne die Definitionen/Auslegungen, Inhalte und Rechtsgrundlagen korrekt zu.</p>
    </div>
    <!-- Fragen q0_1, q0_2, q0_3 wie in deinem Originalcode -->
    <div id="summary0" class="summary"></div>
    <button class="back-btn" onclick="backToStart()">← Zurück zur Übersicht</button>
  </section>

  <!-- Fall 1 -->
  <section id="case1" style="display:none;">
    <div class="case-box">
      <h3>Übungssachverhalt</h3>
      <p><strong>SV:</strong> A, neun Jahre alt, fährt mit seinem Fahrrad auf dem Gehweg.</p>
    </div>
    <!-- Fragen q1_1, q1_2, q1_3 wie in deinem Originalcode -->
    <div id="summary1" class="summary"></div>
    <button class="back-btn" onclick="backToStart()">← Zurück zur Übersicht</button>
  </section>

  <!-- Fall 2 -->
  <section id="case2" style="display:none;">
    <div class="case-box">
      <h3>Übungsfall: Höchstgeschwindigkeiten</h3>
      <p><strong>Aufgabe:</strong> Wie hoch ist die zulässige Höchstgeschwindigkeit der nachfolgenden Fahrzeuge gem. § 3 Abs. 3 bzw. § 18 Abs. 5 StVO?</p>
    </div>
    <!-- Fragen q2_1 bis q2_9 wie in deinem Originalcode -->
    <div id="summary2" class="summary"></div>
    <button class="back-btn" onclick="backToStart()">← Zurück zur Übersicht</button>
  </section>

  <!-- Fall 3 -->
  <section id="case3" style="display:none;">
    <div class="case-box">
      <h3>Übung: Grundlagen des § 1 Abs. 2 StVO</h3>
      <p><strong>Aufgabe:</strong> Beantworten Sie die nachfolgenden Fragen.</p>
    </div>
    <!-- Fragen q3_1 bis q3_3 wie in deinem Originalcode -->
    <div id="summary3" class="summary"></div>
    <button class="back-btn" onclick="backToStart()">← Zurück zur Übersicht</button>
  </section>

  <!-- Fall 4 TBNR zu § 4 StVO -->
  <section id="case4" style="display:none;">
    <div class="case-box">
      <h3>Übung: TBNR zu § 4 StVO</h3>
      <p><strong>Aufgabe:</strong> Bestimmen Sie zu den nachfolgenden Sachverhalten die korrekte Tatbestandsnummer (TBNR). Geben Sie diese in das Textfeld ein.</p>
    </div>

    <div class="question">
      <p><strong>Frage 1:</strong> Pkw, a.g.O., V=100 km/h, s=40 m</p>
      <input type="text" id="eingabe1" maxlength="6" placeholder="TBNR:">
      <button onclick="pruefeAntwort(1)">Antwort prüfen</button>
      <p id="feedback1"></p>
    </div>

    <div id="summary4" class="summary"></div>
    <button class="back-btn" onclick="backToStart()">← Zurück zur Übersicht</button>
  </section>

  <!-- Hinweis-Box unterhalb des Inhalts -->
  <div class="app-hint">
    <p><strong>Installation der Lern-App:</strong></p>
    <p><strong>iOS:</strong> Tippe auf das Teilen-Symbol ⬆︎ und wähle „Zum Home-Bildschirm“.</p>
    <p><strong>Android:</strong> Tippe auf die drei Punkte ⋮ und wähle „Zum Startbildschirm hinzufügen“.</p>
  </div>
  
  <div class="footer-note">© SEBU Verlag Freudenberg – Lern-App Verkehrsrecht GS</div>
</main>

<script>
/* Navigation */
function openCase(id){
  document.getElementById('startPage').style.display='none';
  document.querySelectorAll('section').forEach(s => s.style.display='none');
  const section = document.getElementById(id);
  if(section) section.style.display='block';
}
function backToStart(){
  document.querySelectorAll('section').forEach(s => s.style.display='none');
  document.getElementById('startPage').style.display='block';
}

/* Einzelantwort-Logik */
function checkAnswer(btn,isCorrect){
  const question = btn.parentElement;
  const buttons = question.querySelectorAll('.answer-btn');
  const feedback = question.querySelector('.feedback');

  if([...buttons].some(b=>b.disabled)) return;
  buttons.forEach(b=>b.disabled=true);

  if(isCorrect){
    btn.classList.add('correct');
    feedback.textContent='✅ Richtig!';
    question.dataset.answeredCorrect="true";
  } else {
    btn.classList.add('incorrect');
    feedback.textContent='❌ Leider falsch – bitte schau Dir die Inhalte der Rechtsnormen noch einmal genauer an.';
    buttons.forEach(b=>{
      if(b.getAttribute('onclick').includes('true')) b.classList.add('correct-answer');
    });
    question.dataset.answeredCorrect="false";
  }
  updateSummary(question.closest('section'));
}

function checkAnswerMulti(btn,isCorrect){
  const question = btn.parentElement;
  const buttons = question.querySelectorAll('.answer-btn');
  const feedback = question.querySelector('.feedback');

  if(btn.disabled) return;
  btn.disabled = true;

  if(!question.dataset.correctClicks) question.dataset.correctClicks = "0";
  if(!question.dataset.wrongClicked) question.dataset.wrongClicked = "false";

  if(!isCorrect){
    btn.classList.add('incorrect');
    question.dataset.wrongClicked = "true";
    feedback.textContent='❌ Leider falsch – bitte schau Dir die Inhalte der Rechtsnormen noch einmal genauer an.';
    buttons.forEach(b=>{
      b.disabled = true;
      if(b.getAttribute('onclick').includes('true')) b.classList.add('correct-answer');
    });
    question.dataset.answeredCorrect="false";
    updateSummary(question.closest('section'));
    return;
  }

  btn.classList.add('correct');
  question.dataset.correctClicks = String(parseInt(question.dataset.correctClicks) + 1);

  const totalTrue = Array.from(buttons).filter(b => b.getAttribute('onclick').includes('true')).length;
  const correctClicks = parseInt(question.dataset.correctClicks);

  if(correctClicks === totalTrue && question.dataset.wrongClicked === "false"){
    feedback.textContent='✅ Alle Antworten korrekt!';
    buttons.forEach(b=>b.disabled = true);
    question.dataset.answeredCorrect="true";
    updateSummary(question.closest('section'));
  }
}

function updateSummary(section){
  const questions = section.querySelectorAll('.question');
  let correctCount = 0;
  questions.forEach(q=>{
    if(q.dataset.answeredCorrect === "true") correctCount++;
  });
  section.querySelector('.summary').textContent=`Du hast ${correctCount} von ${questions.length} Fragen richtig beantwortet.`;
}

/* Freitexteingaben prüfen */
function pruefeAntwort(nr) {
  const richtigeAntworten = {
    1: "104100",
    2: "654321",
    3: "112233",
    4: "998877"
  };
  const eingabe = document.getElementById("eingabe" + nr).value.trim();
  const feedback = document.getElementById("feedback" + nr);

  if (eingabe === richtigeAntworten[nr]) {
    feedback.textContent = "✅ Richtig!";
    feedback.style.color = "green";
  } else {
    feedback.textContent = "❌ Falsch – bitte überprüfe deine Eingabe.";
    feedback.style.color = "red";
  }
}

/* Service Worker */
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

</body>
</html>
